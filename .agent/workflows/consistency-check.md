---
description: リポジトリ全般のドキュメントとコードの整合性確認と更新
---

このワークフローは、プロジェクトの実装内容とドキュメント（PRD, README等）の乖離を防ぎ、常に最新の状態を保つための手順です。

1. **実装の解析**
   - `functions/index.js` の SSR ロジックを確認し、提供されている環境変数や置換タグを特定する。
   - `admin.js` のフォームフィールドと Firestore への保存ロジックを確認する。
   - `firestore.rules` のアクセス制限ルールを確認する。

2. **PRD.md の更新**
   - 手順1で確認した現在の「最新仕様」を `PRD.md` に反映させる。
   - 廃止された機能（例: hero-notice）の記述を削除し、追加された機能（例: allowIndexing）を追記する。

3. **README.md の更新**
   - セットアップ手順、運用方法、技術的な注意事項（例: robots.txt のリダイレクト仕様）が現状と一致しているか確認し、更新する。

4. **スクリプトの整合性確認**
   - `tools/setup.js` が Firestore の現在のスキーマと一致しているか確認する。
   - `tools/demo-data.js` 等のテスト/自動化スクリプトが最新の UI 要素（ID, クラス等）に対応しているか確認する。

5. **最終検証**
   - `npm run build` でビルドが通ることを確認する。
   - 必要に応じて `firebase deploy` を行い、環境全体でドキュメント通りの挙動になるか確認する。
